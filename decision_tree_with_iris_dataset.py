# -*- coding: utf-8 -*-
"""Decision Tree with iris dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QuDxEmSqUdfDTVxRN8OvwS1Jjk5gq-cC
"""

import pandas as pd
import matplotlib.pyplot as plt
from sklearn import datasets
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn import tree
from sklearn.metrics import classification_report
from sklearn import preprocessing

from sklearn import preprocessing

from google.colab import drive
drive.mount('/content/drive')

file_name = '/content/sample_data/iris.csv'

import pandas as pd
iris = pd.read_csv(file_name)

iris

iris.head()

label_encoder = preprocessing.LabelEncoder()
iris['Species']= label_encoder.fit_transform(iris['Species'])
iris['Species']

iris.head()

x=iris.iloc[:,0:4]
x

iris=iris.rename(columns={"Species":"Flowers_types"})

iris

label_encoder = preprocessing.LabelEncoder()
iris['Flowers_types']= label_encoder.fit_transform(iris['Flowers_types'])
iris['Flowers_types']

colnames = list(iris.columns)
colnames

x_train,x_test,y_train,y_test = train_test_split(x,iris['Flowers_types'],test_size=0.2,random_state=40)

model = DecisionTreeClassifier(criterion = 'entropy',max_depth=3)
model.fit(x_train,y_train)

tree.plot_tree(model)
plt.show()

fn=['sepal_length','sepal_width','petal_length','petal_width']
cn=['setosa', 'versicolor', 'virginica']
fig,axes=plt.subplots(nrows=1,ncols=1,figsize=(4,4),dpi=300)
tree.plot_tree(model,
               feature_names=fn,
               class_names=cn,
               filled=True);

